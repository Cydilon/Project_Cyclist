# Analyze 
## Describtive analysis

Analysing rider_length: Mean, Median, Max and Min.

``` R
mean(data_cleaned$ride_length)
median(data_cleaned$ride_length)
max(data_cleaned$ride_length)
min(data_cleaned$ride_length)
```
It is also possible to use the summary command to get the same result as above.
```R
summary(data_cleaned$ride_length)
```

Compare the results between annual member with casual rider 
```R
aggregate(data_cleaned$ride_length ~ data_cleaned$member_casual, FUN = mean)
aggregate(data_cleaned$ride_length ~ data_cleaned$member_casual, FUN = median)
aggregate(data_cleaned$ride_length ~ data_cleaned$member_casual, FUN = max)
aggregate(data_cleaned$ride_length ~ data_cleaned$member_casual, FUN = min)
```

## Further analysis

When do riders use the bike at the most throughout the week?
Seperate the date into weekdays starting with Monday. 
```R
aggregate(data_cleaned$ride_length ~ data_cleaned$member_casual + data_cleaned$day_of_week, FUN = mean)
data_cleaned$day_of_week <- ordered(data_cleaned$day_of_week, levels = c("Montag", "Dienstag", "Mittwoch", "Donnerstag", "Freitag", "Samstag", "Sonntag"))
aggregate(data_cleaned$ride_length ~ data_cleaned$member_casual + data_cleaned$day_of_week, FUN = mean)
```

What bike type are casual and annual member are using?
```R
weekday_duration <- data_cleaned %>% 
  mutate(weekday = wday(started_at, label = TRUE)) %>% 
  group_by(member_casual, weekday, rideable_type) %>% 
  summarise(number_of_rides = n(),
            average_duration = mean(ride_length)) %>% 
  arrange(member_casual, weekday, rideable_type) 
``` 

When do riders use the bike at the most throughout the year?
Seperate the data into month.
```R
month_duration <- data_cleaned %>% 
  group_by(member_casual, month, year) %>% 
  summarise(number_of_rides = n(),
            average_duration = mean(ride_length))
``` 


## Visualization 
1. Weekdays & Average_duration sperated into rideable_type
```R
weekday_duration %>% 
  ggplot(aes(x = weekday, y = average_duration, fill = member_casual)) +
  geom_col(position = "dodge") + 
  facet_wrap(~rideable_type)
```
![Weekdays / Average_Duration](https://user-images.githubusercontent.com/67735327/142462340-33794c97-f344-4dde-b3ee-723fbcc7600a.png))


2. Weekdays & Number_of_rides seperated into rideable_type
```R 
weekday_duration %>% 
  ggplot(aes(x = weekday, y = number_of_rides, fill = member_casual)) +
  geom_col(position = "dodge") + 
  facet_wrap(~rideable_type)
```
![Weekdays / Number_Of_Rides](https://user-images.githubusercontent.com/67735327/142462526-e6317f38-c49c-4504-8a6a-589e58f2a4ab.png)

3. Months & Number_of_rides 
```R
month_duration %>% 
  ggplot(aes(x = month, y = number_of_rides, fill = member_casual)) +
  geom_col(position = "dodge") 
```
![Month / Number_Of_Rides](https://user-images.githubusercontent.com/67735327/142462619-e98b5c4a-b6f2-4d64-bfdb-b5572b709728.png)


## Export the summary file for future analysis
```R
counts <- aggregate(data_cleaned$ride_length ~ data_cleaned$member_casual + data_cleaned$day_of_week, FUN = mean)
write.csv(counts, file = 'C:\...\avg_ride_length.csv')
```



